<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Encuestas PAE - Envigado</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Configuraci√≥n de Supabase -->
    <script src="js/config/supabase-config.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <img src="https://www.jotform.com/uploads/juanpamartinezro/form_files/alcaldia_envigado_salud.68925c2d63e0c2.16743275.png" alt="Logo Alcald√≠a de Envigado" class="logo">
                <h1>Sistema de Encuestas PAE</h1>
                <p>Programa de Alimentaci√≥n Escolar - Envigado</p>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="navigation">
            <button class="nav-btn active" data-section="home">Inicio</button>
            <button class="nav-btn" data-section="surveys">Encuestas</button>
            <button class="nav-btn" data-section="results">Resultados</button>
            <button class="nav-btn" data-section="admin">Administraci√≥n</button>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Home Section -->
            <section id="home" class="section active">
                <div class="welcome-card">
                    <h2>Bienvenido al Sistema de Encuestas PAE</h2>
                    <p>Este sistema le permite realizar encuestas de satisfacci√≥n del Programa de Alimentaci√≥n Escolar (PAE) y visualizar los resultados obtenidos.</p>
                    
                    <div class="features-grid">
                        <div class="feature-card">
                            <h3>üìù Realizar Encuestas</h3>
                            <p>Complete las encuestas de satisfacci√≥n disponibles</p>
                            <button class="btn-primary">Ir a Encuestas</button>
                        </div>
                        <div class="feature-card">
                            <h3>üìä Ver Resultados</h3>
                            <p>Visualice gr√°ficos y estad√≠sticas de las respuestas</p>
                            <button class="btn-primary">Ver Resultados</button>
                        </div>
                        <div class="feature-card">
                            <h3>üì• Descargar Datos</h3>
                            <p>Exporte todos los datos a archivos Excel</p>
                            <button class="btn-primary">Administraci√≥n</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Surveys Section -->
            <section id="surveys" class="section">
                <h2>Seleccionar Encuesta</h2>
                <div class="survey-selector">
                    <div class="survey-card" data-survey="racion-servida">
                        <h3>üçΩÔ∏è Raci√≥n Servida</h3>
                        <p>Evaluaci√≥n de satisfacci√≥n del consumidor - Raci√≥n servida en comedor</p>
                        <button class="btn-primary">Realizar Encuesta</button>
                    </div>
                    <div class="survey-card" data-survey="racion-industrializada">
                        <h3>üç™ Raci√≥n Industrializada</h3>
                        <p>Evaluaci√≥n de satisfacci√≥n de la entrega de raci√≥n industrializada (RI)</p>
                        <button class="btn-primary">Realizar Encuesta</button>
                    </div>
                    <div class="survey-card" data-survey="coordinadores">
                        <h3>üë®‚Äçüíº Coordinadores PAE</h3>
                        <p>Evaluaci√≥n del servicio PAE para coordinadores en sedes e instituciones educativas</p>
                        <button class="btn-primary">Realizar Encuesta</button>
                    </div>
                </div>
            </section>

            <!-- Results Section -->
            <section id="results" class="section">
                <h2>Resultados de Encuestas</h2>
                
                <!-- Filtros de An√°lisis Mejorados -->
                <div class="filters-container">
                    <!-- Filtros Principales -->
                    <div class="filters-section">
                        <div class="filters-header">
                            <h3>üîç Filtros de An√°lisis</h3>
                            <button class="toggle-filters-btn" id="toggle-filters">
                                <span class="toggle-icon">‚ñº</span> Mostrar/Ocultar Filtros
                            </button>
                        </div>
                        
                        <div class="filters-content" id="filters-content">
                            <!-- Filtros de Fecha -->
                            <div class="filter-group-collapsible">
                                <div class="filter-group-header" data-target="date-filters">
                                    <h4>üìÖ Filtros de Fecha</h4>
                                    <span class="collapse-icon">‚ñº</span>
                                </div>
                                <div class="filter-group-content" id="date-filters">
                                    <div class="filter-controls">
                                        <div class="filter-row">
                                            <div class="filter-item">
                                                <label for="date-from">Desde:</label>
                                                <input type="date" id="date-from" class="filter-input">
                                            </div>
                                            <div class="filter-item">
                                                <label for="date-to">Hasta:</label>
                                                <input type="date" id="date-to" class="filter-input">
                                            </div>
                                        </div>
                                        <div class="filter-row">
                                            <div class="filter-item">
                                                <label for="period-select">Per√≠odo:</label>
                                                <select id="period-select" class="filter-select">
                                                    <option value="all">Todos los per√≠odos</option>
                                                    <option value="today">Hoy</option>
                                                    <option value="week">Esta semana</option>
                                                    <option value="month">Este mes</option>
                                                    <option value="quarter">Este trimestre</option>
                                                    <option value="year">Este a√±o</option>
                                                    <option value="custom">Personalizado</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Filtros de Instituci√≥n -->
                            <div class="filter-group-collapsible">
                                <div class="filter-group-header" data-target="institution-filters">
                                    <h4>üè´ Filtros por Instituci√≥n</h4>
                                    <span class="collapse-icon">‚ñº</span>
                                </div>
                                <div class="filter-group-content" id="institution-filters">
                                    <div class="filter-controls">
                                        <div class="filter-row">
                                            <div class="filter-item">
                                                <label for="institution-filter">Instituci√≥n:</label>
                                                <select id="institution-filter" class="filter-select">
                                                    <option value="">Todas las instituciones</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="filter-row">
                                            <div class="filter-item">
                                                <label for="grade-filter">Grado:</label>
                                                <select id="grade-filter" class="filter-select">
                                                    <option value="">Todos los grados</option>
                                                    <option value="1">1¬∞</option>
                                                    <option value="2">2¬∞</option>
                                                    <option value="3">3¬∞</option>
                                                    <option value="4">4¬∞</option>
                                                    <option value="5">5¬∞</option>
                                                    <option value="6">6¬∞</option>
                                                    <option value="7">7¬∞</option>
                                                    <option value="8">8¬∞</option>
                                                    <option value="9">9¬∞</option>
                                                    <option value="10">10¬∞</option>
                                                    <option value="11">11¬∞</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Filtros Demogr√°ficos -->
                            <div class="filter-group-collapsible">
                                <div class="filter-group-header" data-target="demographic-filters">
                                    <h4>üë• Filtros Demogr√°ficos</h4>
                                    <span class="collapse-icon">‚ñº</span>
                                </div>
                                <div class="filter-group-content" id="demographic-filters">
                                    <div class="filter-controls">
                                        <div class="filter-row">
                                            <div class="filter-item">
                                                <label for="age-range-filter">Rango de edad:</label>
                                                <select id="age-range-filter" class="filter-select">
                                                    <option value="">Todas las edades</option>
                                                    <option value="5-8">5-8 a√±os</option>
                                                    <option value="9-12">9-12 a√±os</option>
                                                    <option value="13-16">13-16 a√±os</option>
                                                    <option value="17-20">17-20 a√±os</option>
                                                </select>
                                            </div>
                                            <div class="filter-item">
                                                <label for="sex-filter">Sexo:</label>
                                                <select id="sex-filter" class="filter-select">
                                                    <option value="">Todos</option>
                                                    <option value="Hombre">Hombre</option>
                                                    <option value="Mujer">Mujer</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Tipo de An√°lisis -->
                            <div class="filter-group-collapsible">
                                <div class="filter-group-header" data-target="analysis-type-filters">
                                    <h4>üìä Tipo de An√°lisis</h4>
                                    <span class="collapse-icon">‚ñº</span>
                                </div>
                                <div class="filter-group-content" id="analysis-type-filters">
                                    <div class="filter-controls">
                                        <div class="analysis-type-controls">
                                            <label class="radio-option">
                                                <input type="radio" name="analysis-type" value="general" checked>
                                                <span>An√°lisis General</span>
                                            </label>
                                            <label class="radio-option">
                                                <input type="radio" name="analysis-type" value="specific">
                                                <span>An√°lisis por Encuesta</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Botones de Acci√≥n -->
                            <div class="filter-actions">
                                <button id="apply-filters" class="btn-primary">
                                    <span class="btn-icon">üîç</span> Aplicar Filtros
                                </button>
                                <button id="clear-filters" class="btn-secondary">
                                    <span class="btn-icon">üóëÔ∏è</span> Limpiar Filtros
                                </button>
                                <button id="auto-load-institutions" class="btn-info">
                                    <span class="btn-icon">üîÑ</span> Cargar Instituciones
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="results-controls">
                    <select id="survey-select" class="form-control">
                        <option value="">Seleccionar encuesta</option>
                        <option value="racion-servida">Raci√≥n Servida</option>
                        <option value="racion-industrializada">Raci√≥n Industrializada</option>
                        <option value="coordinadores">Coordinadores PAE</option>
                    </select>
                    <button id="load-results" class="btn-primary">Cargar Resultados</button>
                </div>
                
                <div id="results-content" class="results-content">
                    <div class="no-results">
                        <p>Seleccione una encuesta para ver los resultados</p>
                    </div>
                </div>
            </section>

            <!-- Admin Section -->
            <section id="admin" class="section">
                <h2>Administraci√≥n</h2>
                <div class="admin-controls">
                    <div class="admin-card">
                        <h3>üìä Estad√≠sticas Generales</h3>
                        <div id="general-stats" class="stats-grid">
                            <!-- Se llenar√° din√°micamente -->
                        </div>
                    </div>
                    
                    <div class="admin-card">
                        <h3>üì• Exportar Datos</h3>
                        <p>Descargue todos los datos de las encuestas en formato Excel</p>
                        <button id="export-all" class="btn-success">Exportar Todo</button>
                    </div>
                    
                    <div class="admin-card">
                        <h3>üóëÔ∏è Papelera</h3>
                        <p>Respuestas eliminadas (no se pueden borrar definitivamente)</p>
                        <button id="view-trash" class="btn-warning">Ver Papelera</button>
                    </div>
                </div>
                
                <!-- Secci√≥n de Papelera -->
                <div id="trash-section" class="trash-section" style="display: none;">
                    <h3>üóëÔ∏è Respuestas Eliminadas</h3>
                    <div id="trash-content">
                        <!-- Se llenar√° din√°micamente -->
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Survey Modal -->
    <div id="survey-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">Encuesta</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div id="survey-content">
                    <!-- Se llenar√° din√°micamente con el contenido de la encuesta -->
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading" class="loading-overlay">
        <div class="spinner"></div>
        <p>Cargando...</p>
    </div>

    <script src="script.js"></script>
</body>
</html>
